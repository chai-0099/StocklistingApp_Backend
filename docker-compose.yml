version: '3.4'

#Add bridge network
networks:
    stocklistingnetwork:
        

services:

## Add the stocklistingdb service as a sql server container
    stocklistingdb:
            container_name: stocklistingdb
            image: mcr.microsoft.com/mssql/server:2019-latest
            ports:
                - 8002:1433
            environment:
                - ACCEPT_EULA=Y
                - MSSQL_SA_PASSWORD=Password123
            networks:
                - stocklistingnetwork
        
## Add the stocklisting service as a .net core container
    stocklisting:
        image: ${DOCKER_REGISTRY-}stocklisting
        container_name: stocklistingapp
        build:
              context: .
              dockerfile: Stocklisting/Dockerfile
        ports:
            - 8081:80
        depends_on:
               - stocklistingdb
        networks:
               - stocklistingnetwork
